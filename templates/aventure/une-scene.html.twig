
<article id="scn{{ une_scene.id }}" class="relative mb-5">

    <div class="bg-black">
        <img class="card-img-top img-fluid mask" src="{{ asset(une_scene.image) }}"  alt="Image d'une scène">
    </div>

    <div class="text-right ligne-pnjs" style="position: absolute; top: 1rem; right: 1rem;">
        <div class="d-flex flex-column">   
            {% for une_participation in une_scene.participations %}
                {% if une_participation.estPj == 0 %}
                    <div class="mb-2" style="display: inline-block; position: relative;">
                        <a href="{{path('personnage_profil',{id: une_participation.personnage.id})}}" >
                            {% if une_participation.estMort == 1 %}
                                <img src="{{asset('assets/img/icons/mort.png')}}" alt="est mort" style="width: 72px; position: absolute; top: -4px; left: -2px; z-index: 1;" />
                            {% endif %}
                            <img class="ombre-img character-icon-64 {% if une_participation.estMort == 1 %}dead{% else %}hover-shine{% endif %}"
                                src="{{asset(une_participation.personnage.icone)}}" alt="Icone du Personnage" title="{{une_participation.personnage.prenom}}" />
                        </a>
                    </div>
                {% endif %}
            {% endfor %}
        </div>
    </div>

    <div class="card-body scene-body relative">

            <!-- LEGENDE OVERLAY -->
            <div class="scene-daytime" style="width: 91%;">
                <h5 class="card-title">{{ une_scene.temps }}</h5>
                <h3 class="card-title">{{ une_scene.titre }}</h3>
                <div class="text-right ligne-icones ligne-pjs">
                    {% for une_participation in une_scene.participations %}
                        {% if une_participation.estPj %}
                            <div style="display: inline-block; position: relative;">
                                {% if une_participation.xpGagne != 0 and une_participation.estMort != 1 %}
                                    <strong class="{% if une_participation.personnage.joueur == app.user %}votre-xp{% else %}xp{% endif %}">+{{une_participation.xpGagne}}XP</strong>
                                {% endif %}
                                <br/>
                                <a href="{{path('personnage_profil',{id:une_participation.personnage.id})}}" >
                                    {% if une_participation.estMort == 1 %}
                                        <img src="{{asset('assets/img/icons/mort.png')}}" alt="est mort" style="width: 72px; position: absolute; top: -4px; left: -2px; z-index: 1;" />
                                    {% endif %}
                                    <img class="character-icon-64 {% if une_participation.personnage.joueur == app.user %}outlined{% endif %} {% if une_participation.estMort == 1 %}dead{% elseif une_participation.xpGagne == 0 %}grayscale{% else %}hover-shine{% endif %}"
                                         src="{{asset(une_participation.personnage.icone)}}" alt="Icone du Personnage" title="{{une_participation.personnage.prenom}}" />
                                </a>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>

        <!-- TEXTE -->
        <p class="card-text scene-text text-justify">{{ une_scene.texte|raw|nl2br }}</p>
        {# Il faut mettre le RAW avant pour avoir les balises html et autre caractères spéciaux non échappés #}

    </div>

    <!-- MJ - MODIFIER | SUPRIMER -->
    {% if app.user and is_granted("ROLE_MJ") %}
        <div class="d-flex justify-content-center mt-3">
            <div class="col col-lg-2 text-right">
                <a href="{{ path('admin_scene_edit', {id:une_scene.id} ) }}?redirect=episode"><i class="fas fa-edit"></i>&nbsp;&nbsp;Modifier</a>
            </div>
            <div>
                &nbsp;&nbsp;&nbsp;&nbsp;
            </div>
            <div class="col col-lg-2 text-left">
                <a  href="{{ path('admin_scene_delete', {id: une_scene.id} ) }}?csrf={{ csrf_token('delete' ~ une_scene.id) }}&redirect=episode"
                    onclick="return confirm('Êtes-vous sûr de vouloir supprimer la scène : {{une_scene.titre}} ?')">
                        <i class="fas fa-trash-alt"></i>&nbsp;&nbsp;Supprimer
                </a>
            </div>
        </div>
    {% endif %}

    {{ include('/parts/separateur-ornament.html.twig') }}

</article>
<!-- FIN : UNE SCENE -->