{% extends 'element.html.twig' %}

{% block stylesheets %}
        {{parent()}}
        <link rel="stylesheet" href="{{asset('css/clan.css')}}" />
{% endblock %}

{% block element_content %} 

    {# BANNER INTRO #}
    {% set category, entity, un_element, icone, invert , all_elements = 'empire', 'clan' , clan, clan.mon, '' , toutClans %}
    {{ include('parts/banner-intro.html.twig') }}

    {# FAMILLES #}
    <section class="col-8 p-1">
        <div class="card card-body pt-4 h-100 relative">

            <!-- BTN MJ ADD -->
            {% set redirect, entity, position, label_one, options = 'clan', 'famille', 'right-corner-16', 'une famille', 'clanID=' ~ clan.id %}
            {{ include('/parts/btn-box-add-element.html.twig', {entity}) }}

            <h2 class="card-title"><strong>Familles</strong></h2>
            <div class="card-text">

                {% for une_famille in clan.familles %}
                    <hr>
                    <article class="my-4 row align-items-start relative">

                        {% if app.user and is_granted("ROLE_MJ") %}
                        <!-- MJ BTN ICON EDIT -->
                            {% set redirect, entity, un_element, size, color, position = 'clan', 'famille', une_famille, 'medium', 'text-accent', 'right-corner-snap' %}
                            {{ include('/parts/btn-icon-edit.html.twig') }}
                        {% endif %}

                        <div class="col-lg-3 text-center d-flex flex-column">
                            <img class="img-fluid" src="{{ asset(une_famille.mon) }}" alt="Mon Famille" />

                            {% if une_famille.chef is not empty %}
                                <a class="mt-3 hover-no-under hover-zoom-x2" href="{{ path('personnage_profil', {id: une_famille.chef.id} ) }}" title="{{une_famille.chef.nom}} {{une_famille.chef.prenom}}">
                                    <img class="character-icon-small" src="{{ asset(une_famille.chef.icone) }}" alt="Icône du personnage" />
                                    <span class="text-muted align-middle">Daimyo</span>
                                </a>                                 
                            {% endif %}

                        </div>

                        <div class="col-lg-9">
                            <h3><strong> {{ une_famille.nom }}</strong></h3>
                            <strong>{{une_famille.bonus|upper}}</strong>
                            <p class="text-justify text-medium mt-2 pr-2">{{ une_famille.description|raw|nl2br }}</p>
                        </div>

                    </article>
                {% else %}
                    <span class="text-muted"><i>Familles à venir</i></span>
                {% endfor %}

            </div>
        </div>
    </section>

    {# ECOLES DU CLAN #}
    <section class="col-4 p-1">
        <div class="card card-body pt-4 h-100">

            <!-- BTN MJ ADD -->
            {% set redirect, entity, position, label_one, options = 'clan', 'ecole', 'right-corner-16', 'une école', 'clanID=' ~ clan.id %}
            {{ include('/parts/btn-box-add-element.html.twig', {entity}) }}

            <h2 class="card-title"><strong>Écoles</strong></h2>
            <hr>

            {% for une_ecole in clan.ecoles %}
            <a class="vignette-aside mb-3" href="{{ path('regles_ecole', {id: une_ecole.id} ) }}">
                <strong>{{ une_ecole.nom|upper }}</strong>
                <img class="img-fluid" src="{{ asset(une_ecole.image) }}" alt="Image d'une école" />
            </a>
            {% else %}
                <i class="text-muted">Écoles à venir.</i>
            {% endfor %}

        </div>
    </section>
        
    {# TERRITOIRES #}
    {% if clan.territoireDesc is defined and clan.territoireDesc is not empty %}
    <section class="col-8 p-1">
            <div class="card card-body pt-4 h-100">
                <h2 class="card-title"><strong>Territoires</strong></h2>
                <hr>

                {% if clan.territoireCarte %}
                    <img id="carte" class="img-fluid" src="{{asset(clan.territoireCarte)}}" alt="Carte du Territoire du clan" />
                {% endif %}

                {% if clan.territoireDesc %}
                    <p class="text-justify mt-3 px-5 py-3 text-medium">{{clan.territoireDesc}}</p>
                {% else %}
                    <p class="text-muted"><i>Description des Territoires à venir.</i></p>
                {% endif %}

            </div>

            <!-- Carte Zoomed Modal -->
            <div id="carteZoomModal" class="modalCarte">
                <span class="closeModal">&times;</span>
                <img class="modalCarte-content" id="carteModal">
            </div>
    </section>
    {% endif %}

    {# LIEUX  #}
    {% if clan.lieux is defined and clan.lieux is not empty %}
    <section class="col-4 p-1">
        <div class="card card-body pt-4 h-100">
            <h2 class="card-title"><strong>Lieux</strong></h2>
            <hr>
            {% for un_lieu in clan.lieux %}
                <a class="vignette-aside mb-3" href="{{path('empire_lieu', {id: un_lieu.id} )}}">
                    <!-- ICON ON TOP -->
                    {% if un_lieu.icone is defined and un_lieu.icone is not empty %}
                        <img class="icon-lieu-top img-64" src="{{ asset(un_lieu.icone) }}" alt="une icône" />
                    {% endif %}

                    <strong>{{ un_lieu.nom|upper }}</strong>
                    <img class="img-fluid" src="{{asset(un_lieu.image)}}" alt="Image d'un Lieu" /></a>
                </a>
            {% else %}
                <p class="text-muted"><i>Pas de Lieux à charger.</i></p>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    {# AUTRES #}
    {% if clan.longDescription is defined and clan.longDescription is not empty %}  
    <section class="col-8 p-1">
        <div class="card card-body pt-4 h-100">
            <h2 class="card-title"><strong>Autres</strong></h2>
            <hr>
            <p class="card-text text-justify px-5 py-3 text-medium">
                {{ clan.longDescription|raw|nl2br }}
            </p>
        </div>
    </section>
    {% endif %}

    {# PERSONNAGES #}
    <aside class="{% if clan.longDescription is defined and clan.longDescription is not empty %}col-4{% else %}col-12{% endif %} p-1">
        <div class="card card-body pt-4 h-100">
            {# <h2 class="card-title"><strong>Personnages</strong></h2>
            <hr> #}
            <div class="card-text row ml-2">
                {% for un_personnage in clan.personnages %}
                    <a class="p-2 hover-zoom-x2" href="{{ path('personnage_profil', {id: un_personnage.id} ) }}" >
                        <img class="img-128 rounded-8" src="{{ asset(un_personnage.icone) }}" alt="Icône du personnage" />
                    </a>
                {% else %}
                    <span class="text-muted">Pas encore de personnages disponible pour ce clan.</span>
                {% endfor %}
            </div>
        </div>
    </aside>

{% endblock %}

{% block javascripts %}
    {{parent()}}
    <script src="{{ asset('scripts/clan.js') }}"></script>
{% endblock %}
